<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cqut.czb.bn.dao.mapper.autoRecharge.OfflineDistributorOfAdministratorMapperExtra">
    <select id="getRechargeTableList" parameterType="com.cqut.czb.bn.entity.dto.AccountRechargeDTO" resultType="com.cqut.czb.bn.entity.dto.AccountRechargeDTO">
        SELECT
        b.user_account AS account,
        a.amount AS rechargeAmount,
        ( a.amount + a.before_balance ) AS balance,
        a.recharge_time AS rechargeTime
        FROM
        `czb_offline_distributor_records` AS a
        JOIN czb_user AS b ON a.buyer_id = b.user_id
        <where>
        <if test="account != null and account != ''">
            and b.user_account = #{account,jdbcType=VARCHAR}
        </if>
        <if test="startTime!= null and startTime!= '' and endTime!= null and endTime!= ''">
            AND ( a.create_at BETWEEN #{startTime} AND #{endTime} )
        </if>
    </where>
        ORDER BY
        rechargeTime DESC
    </select>

    <select id="getOfflineConsumptionList" parameterType="com.cqut.czb.bn.entity.dto.OfflineConsumptionDTO" resultType="com.cqut.czb.bn.entity.dto.OfflineConsumptionDTO">
        SELECT
            a.petrol_num AS petrolNum,
            a.turnover_amount AS amount,
            a.state AS state,
            b.user_account AS account,
            a.transaction_time AS rechargeTime
        FROM
            `czb_petrol_sales_records` AS a
            JOIN czb_user AS b ON a.buyer_id = b.user_id
        <where>
            a.record_type = 3
            <if test="petrolNum != null and account != ''">
              and a.petrol_num =  #{petrolNum,jdbcType=VARCHAR}
            </if>
            <if test="state != null and account != ''">
                and a.state =  #{state}
            </if>
            <if test="account != null and account != ''">
                and b.user_account = #{account,jdbcType=VARCHAR}
            </if>
            <if test="startTime!= null and startTime!= '' and endTime!= null and endTime!= ''">
                AND ( a.transaction_time BETWEEN #{startTime} AND #{endTime} )
            </if>
        </where>
        ORDER BY
            rechargeTime DESC
    </select>

    <select id="getOfflineClientList" parameterType="com.cqut.czb.bn.entity.dto.OfflineClientDTO" resultType="com.cqut.czb.bn.entity.dto.OfflineClientDTO">

    </select>
</mapper>